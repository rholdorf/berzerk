---
phase: 03-animation-runtime
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - Berzerk/Content/Models/Idle.fbx
  - Berzerk/Content/Models/walk.fbx
  - Berzerk/Content/Models/run.fbx
  - Berzerk/Content/Models/bash.fbx
autonomous: false

must_haves:
  truths:
    - "Animation-only FBX files contain full skeleton data (65 bones) matching test-character.fbx"
    - "Content build succeeds for all 5 FBX files after replacement"
    - "Each animation XNB contains a SkinningData with 65 bones and full-skeleton keyframes (not just 1 bone channel)"
  artifacts:
    - path: "Berzerk/Content/Models/Idle.fbx"
      provides: "Idle animation FBX with full skeleton"
    - path: "Berzerk/Content/Models/walk.fbx"
      provides: "Walk animation FBX with full skeleton"
    - path: "Berzerk/Content/Models/run.fbx"
      provides: "Run animation FBX with full skeleton"
    - path: "Berzerk/Content/Models/bash.fbx"
      provides: "Bash animation FBX with full skeleton"
  key_links:
    - from: "Animation FBX files"
      to: "MixamoModelProcessor"
      via: "Content Pipeline build"
      pattern: "ProcessAnimations.*FlattenSkeleton"
---

<objective>
Re-download Mixamo animation FBX files with "With Skin" option to fix bone coverage.

Purpose: Current animation-only FBX files (idle, walk, run, bash) were downloaded "without skin," causing the processor to extract only 1 bone channel (mixamorig:Hips) per file. With full skeleton data, the processor's FlattenSkeleton path produces correct 65-bone animation clips that match test-character.fbx's bone ordering.

Output: Four replacement FBX files with full skeleton data, rebuilt XNB content.
</objective>

<execution_context>
@/Users/rui/.claude/get-shit-done/workflows/execute-plan.md
@/Users/rui/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-content-pipeline-processor/02-01-SUMMARY.md
@.planning/phases/03-animation-runtime/03-RESEARCH.md
</context>

<tasks>

<task type="checkpoint:human-action" gate="blocking">
  <name>Task 1: Re-download animation FBX files from Mixamo with "With Skin"</name>
  <action>
    The user must re-download 4 animation FBX files from Mixamo.com with the "With Skin" option enabled.
    This cannot be automated because Mixamo requires browser-based authentication and UI interaction.

    For each of the 4 animations (idle, walk, run, bash):
    1. Go to https://www.mixamo.com
    2. Find the same character used for test-character.fbx
    3. Search for the animation (idle, walking, running, sword and shield bash or equivalent)
    4. Click Download
    5. In the download dialog, select Format: FBX Binary (.fbx)
    6. CRITICAL: Check "With Skin" option (this is the key change)
    7. Leave other settings at defaults (30 fps)
    8. Download and replace the existing file in Berzerk/Content/Models/

    Expected file replacements:
    - Berzerk/Content/Models/Idle.fbx (replace existing)
    - Berzerk/Content/Models/walk.fbx (replace existing)
    - Berzerk/Content/Models/run.fbx (replace existing)
    - Berzerk/Content/Models/bash.fbx (replace existing)

    The "With Skin" option embeds the full skeleton mesh in each FBX file. This makes the files larger
    but ensures MixamoModelProcessor finds a skeleton via MeshHelper.FindSkeleton and processes all
    65 bone channels through the FlattenSkeleton path (matching test-character.fbx bone ordering).
  </action>
  <resume-signal>Type "done" after replacing all 4 FBX files, or "skip" to proceed with current files (animations will only move the Hips bone)</resume-signal>
</task>

<task type="auto">
  <name>Task 2: Rebuild content and verify bone counts</name>
  <files>Berzerk/Content/bin/</files>
  <action>
    After the user replaces FBX files, rebuild the content pipeline and verify all animation FBX files
    now produce SkinningData with 65 bones (matching test-character.fbx).

    1. Run `dotnet build` from the solution root to trigger content pipeline rebuild
    2. Check build output for bone counts -- each animation file should now show ~65 bones instead of 0
    3. If any file still shows 0 bones, the "With Skin" option was not enabled for that file

    Expected build output per file:
    - test-character.fbx: 65 bones, 1 clip
    - Idle.fbx: 65 bones, 1 clip ("mixamo.com"), keyframes covering all 65 bone channels
    - walk.fbx: 65 bones, 1 clip, full bone coverage
    - run.fbx: 65 bones, 1 clip, full bone coverage
    - bash.fbx: 65 bones, 1 clip, full bone coverage

    If bone count is 0 for any animation file, report to user that they need to re-download
    that specific file with "With Skin" enabled.
  </action>
  <verify>
    `dotnet build` succeeds. Build output shows 65 bones for all 5 FBX files (not 0 for animation files).
  </verify>
  <done>All 5 FBX files produce SkinningData with 65 bones and full-skeleton animation clips.</done>
</task>

</tasks>

<verification>
- Content pipeline build succeeds for all 5 FBX files
- Each animation FBX now shows 65 bones in build output (not 0)
- Animation clips contain keyframes for all 65 bones (not just 1 bone channel)
</verification>

<success_criteria>
All 4 animation FBX files replaced with "With Skin" versions. Content build succeeds and produces
SkinningData with 65 bones per file. Bone indices will match test-character.fbx because both go
through FlattenSkeleton.
</success_criteria>

<output>
After completion, create `.planning/phases/03-animation-runtime/03-01-SUMMARY.md`
</output>
