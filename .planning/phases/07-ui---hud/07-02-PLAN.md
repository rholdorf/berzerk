---
phase: 07-ui-hud
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - Berzerk/Source/UI/StartMenu.cs
  - Berzerk/Source/UI/PauseMenu.cs
autonomous: true

must_haves:
  truths:
    - "StartMenu displays 'Start Game' button with hover feedback and fires event on click"
    - "PauseMenu displays 'PAUSED' title with 'Resume' and 'Quit' buttons over darkened overlay"
    - "Both menus use mouse click detection with previous/current state tracking"
  artifacts:
    - path: "Berzerk/Source/UI/StartMenu.cs"
      provides: "Initial game screen with Start Game button"
      exports: ["StartMenu"]
    - path: "Berzerk/Source/UI/PauseMenu.cs"
      provides: "Pause overlay with Resume and Quit buttons"
      exports: ["PauseMenu"]
  key_links:
    - from: "Berzerk/Source/UI/StartMenu.cs"
      to: "BerzerkGame"
      via: "OnStartGame event"
      pattern: "event Action.*OnStartGame"
    - from: "Berzerk/Source/UI/PauseMenu.cs"
      to: "BerzerkGame"
      via: "OnResume and OnQuit events"
      pattern: "event Action.*(OnResume|OnQuit)"
---

<objective>
Create start menu and pause menu screen components with mouse-driven button interaction.

Purpose: Implement the two new menu screens that Phase 7 integration (Plan 03) will wire into BerzerkGame's state machine. Start menu provides game entry point, pause menu provides in-game ESC overlay. Both follow the existing programmatic texture pattern and use event-driven architecture for loose coupling.

Output: Two new files - StartMenu with centered "Start Game" button, PauseMenu with "PAUSED" title and Resume/Quit buttons over semi-transparent overlay.
</objective>

<execution_context>
@/Users/rui/.claude/get-shit-done/workflows/execute-plan.md
@/Users/rui/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-ui---hud/07-CONTEXT.md
@.planning/phases/07-ui---hud/07-RESEARCH.md

# Existing UI patterns to follow:
@Berzerk/Source/UI/GameOverScreen.cs
@Berzerk/Source/UI/HealthBar.cs
@Berzerk/Source/Input/InputManager.cs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create StartMenu and PauseMenu screen components</name>
  <files>
    Berzerk/Source/UI/StartMenu.cs
    Berzerk/Source/UI/PauseMenu.cs
  </files>
  <action>
Create two new menu screen files following established project patterns:

**StartMenu.cs** (in Berzerk/Source/UI/):
- Namespace: `Berzerk.UI`
- Fields: `SpriteFont _font`, `Texture2D _pixelTexture`, `Rectangle _buttonBounds`, `bool _isHovering`
- Event: `event Action? OnStartGame`
- LoadContent(ContentManager content, GraphicsDevice graphicsDevice):
  - Load SpriteFont "Font"
  - Create 1x1 pixel texture (same pattern as HealthBar/GameOverScreen)
- Update(MouseState currentMouse, MouseState previousMouse):
  - Check if mouse is within `_buttonBounds` using `Rectangle.Contains`
  - Detect click: `currentMouse.LeftButton == ButtonState.Released && previousMouse.LeftButton == ButtonState.Pressed && _isHovering`
  - Fire `OnStartGame` on click
- Draw(SpriteBatch spriteBatch, Viewport viewport):
  - Draw black background (full screen) — clean minimal entry per CONTEXT
  - Draw game title "BERZERK" in white, centered horizontally, above center (~viewport.Height / 2f - 80)
  - Compute button bounds: measure "Start Game" text, add 40px horizontal / 20px vertical padding, center horizontally at viewport.Height / 2f + 20
  - Store computed bounds to `_buttonBounds` for hit testing
  - Draw button background: `Color.DarkGray` on hover, `Color.Gray * 0.5f` normally — per CONTEXT "minimal white/gray"
  - Draw "Start Game" text centered within button bounds, Color.White
  - Per CONTEXT: "Just 'Start Game' button — minimal entry, immediate action"

**PauseMenu.cs** (in Berzerk/Source/UI/):
- Namespace: `Berzerk.UI`
- Fields: `SpriteFont _font`, `Texture2D _pixelTexture`, `Rectangle _resumeButton`, `Rectangle _quitButton`, `bool _isHoveringResume`, `bool _isHoveringQuit`
- Events: `event Action? OnResume`, `event Action? OnQuit`
- LoadContent(ContentManager content, GraphicsDevice graphicsDevice):
  - Load SpriteFont "Font"
  - Create 1x1 pixel texture
- Update(MouseState currentMouse, MouseState previousMouse):
  - Check hover state for both buttons using Rectangle.Contains
  - Detect click (released after pressed): fire OnResume or OnQuit accordingly
- Draw(SpriteBatch spriteBatch, Viewport viewport):
  - Draw semi-transparent black overlay: `Color.Black * 0.7f` full screen — darkens gameplay behind
  - Draw "PAUSED" title in Color.White, centered horizontally, at viewport.Height / 2f - 100
  - Draw "Resume" button centered at viewport.Height / 2f (same button pattern as StartMenu)
  - Draw "Quit" button centered at viewport.Height / 2f + 60
  - Button style: same as StartMenu (gray background, darker on hover, white text)
  - Extract a private helper `DrawButton(SpriteBatch, string text, float centerY, bool isHovering, out Rectangle bounds, Viewport viewport)` to avoid code duplication between the two buttons

**Button Pattern (shared by both menus):**
- Measure text with _font.MeasureString
- Button width = textSize.X + 40, height = textSize.Y + 20
- Center button: x = viewport.Width / 2 - buttonWidth / 2, y = centerY - buttonHeight / 2
- Background: hover ? Color.DarkGray : Color.Gray * 0.5f
- Text: Color.White, centered within button bounds

**Input Pattern:** Both menus take MouseState current + previous as parameters (NOT InputManager). BerzerkGame will pass Mouse.GetState() + tracked previous state. This keeps menus decoupled from InputManager.
  </action>
  <verify>
Run `dotnet build Berzerk/Berzerk.csproj` — must compile with no errors. Verify both files exist and contain expected events (OnStartGame, OnResume, OnQuit).
  </verify>
  <done>
StartMenu renders title + "Start Game" button, fires OnStartGame on click. PauseMenu renders darkened overlay with "PAUSED" title + Resume/Quit buttons, fires corresponding events. Both use consistent button styling per CONTEXT minimalist white/gray. Both compile cleanly.
  </done>
</task>

</tasks>

<verification>
1. `dotnet build Berzerk/Berzerk.csproj` passes with no errors
2. Both files exist under Berzerk/Source/UI/
3. StartMenu has OnStartGame event, Update with mouse states, Draw with viewport
4. PauseMenu has OnResume and OnQuit events, semi-transparent overlay, two buttons
5. Both use programmatic 1x1 pixel texture pattern from existing codebase
6. Button hover feedback implemented (visual change on mouse hover)
</verification>

<success_criteria>
- Two new source files created and compiling
- StartMenu: black background, "BERZERK" title, "Start Game" button with hover feedback
- PauseMenu: semi-transparent overlay, "PAUSED" title, Resume + Quit buttons
- Event-driven architecture (no direct BerzerkGame coupling)
- Mouse interaction uses current/previous state pattern per research
</success_criteria>

<output>
After completion, create `.planning/phases/07-ui---hud/07-02-SUMMARY.md`
</output>
