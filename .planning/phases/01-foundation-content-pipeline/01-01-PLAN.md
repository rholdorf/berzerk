---
phase: 01-foundation-content-pipeline
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - Berzerk.sln
  - Berzerk/Berzerk.csproj
  - Berzerk/BerzerkGame.cs
  - Berzerk/Program.cs
  - Berzerk/Content/Content.mgcb
  - Berzerk.ContentPipeline/Berzerk.ContentPipeline.csproj
  - .config/dotnet-tools.json
autonomous: true

must_haves:
  truths:
    - "MonoGame project builds successfully on macOS (cross-platform validated in later phase)"
    - "Game window opens when running the project"
    - "Content pipeline extension project compiles"
  artifacts:
    - path: "Berzerk.sln"
      provides: "Solution file linking game and content pipeline projects"
    - path: "Berzerk/Berzerk.csproj"
      provides: "Main game project with MonoGame.Framework.DesktopGL"
      contains: "MonoGame.Framework.DesktopGL"
    - path: "Berzerk.ContentPipeline/Berzerk.ContentPipeline.csproj"
      provides: "Content pipeline extension project"
      contains: "MonoGame.Framework.Content.Pipeline"
    - path: "Berzerk/BerzerkGame.cs"
      provides: "Main game class with game loop"
      contains: "class BerzerkGame"
  key_links:
    - from: "Berzerk.sln"
      to: "Berzerk/Berzerk.csproj"
      via: "solution project reference"
    - from: "Berzerk.sln"
      to: "Berzerk.ContentPipeline/Berzerk.ContentPipeline.csproj"
      via: "solution project reference"
    - from: "Berzerk/Content/Content.mgcb"
      to: "Berzerk.ContentPipeline"
      via: "/reference directive"
      pattern: "/reference:.*Berzerk\\.ContentPipeline"
---

<objective>
Create MonoGame solution with game project and content pipeline extension project

Purpose: Establish the foundational project structure that all subsequent development builds upon. The content pipeline extension project is critical for Phase 1's FBX import work.
Output: Working MonoGame solution with two projects - main game and content pipeline extension

Note: This plan validates macOS build. Cross-platform (Windows/Linux) build verification is deferred to a later phase after core gameplay is working, as primary development is on macOS.
</objective>

<execution_context>
@/Users/rui/.claude/get-shit-done/workflows/execute-plan.md
@/Users/rui/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-content-pipeline/01-RESEARCH.md
@.planning/phases/01-foundation-content-pipeline/01-CONTEXT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create MonoGame Solution and Game Project</name>
  <files>
    Berzerk.sln
    Berzerk/Berzerk.csproj
    Berzerk/BerzerkGame.cs
    Berzerk/Program.cs
    Berzerk/Content/Content.mgcb
    .config/dotnet-tools.json
  </files>
  <action>
Create the MonoGame project using the official DesktopGL template:

1. Install MonoGame templates if not present:
   ```bash
   dotnet new install MonoGame.Templates.CSharp
   ```

2. Create the game project:
   ```bash
   dotnet new mgdesktopgl -n Berzerk
   ```

3. Rename Game1.cs to BerzerkGame.cs immediately (per research anti-pattern advice):
   - Update class name from Game1 to BerzerkGame
   - Update Program.cs to use BerzerkGame

4. Create local tool manifest for MGCB:
   ```bash
   dotnet new tool-manifest
   dotnet tool install dotnet-mgcb
   ```

5. Configure .csproj for always-rebuild content and fail-fast on errors:
   - Add property: MonoGameContentBuilderExitOnError = true
   - Add rebuild flag to content build task

6. Create solution file and add the game project:
   ```bash
   dotnet new sln -n Berzerk
   dotnet sln add Berzerk/Berzerk.csproj
   ```

Important: Use .NET 8 as minimum (per RESEARCH.md - MonoGame 3.8.4.1 supports .NET 8+).
  </action>
  <verify>
Run:
```bash
dotnet build Berzerk.sln
dotnet run --project Berzerk/Berzerk.csproj
```
Build succeeds on macOS. Game window opens with cornflower blue background. Close window manually.
  </verify>
  <done>
MonoGame game project builds and runs on macOS, showing empty game window. Project uses BerzerkGame class name.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Content Pipeline Extension Project</name>
  <files>
    Berzerk.ContentPipeline/Berzerk.ContentPipeline.csproj
    Berzerk/Content/Content.mgcb
    Berzerk.sln
  </files>
  <action>
Create the content pipeline extension project that will host custom FBX processors:

1. Create class library project:
   ```bash
   mkdir Berzerk.ContentPipeline
   cd Berzerk.ContentPipeline
   dotnet new classlib -n Berzerk.ContentPipeline
   ```

2. Configure .csproj for content pipeline:
   - Target net8.0 (matches main project)
   - Platform target: AnyCPU (required - content pipeline doesn't support x86)
   - Add package reference: MonoGame.Framework.Content.Pipeline 3.8.4.1
   - Add using directive for Assimp if needed later

3. Remove default Class1.cs (will add real processors in Plan 02)

4. Add project to solution:
   ```bash
   dotnet sln Berzerk.sln add Berzerk.ContentPipeline/Berzerk.ContentPipeline.csproj
   ```

5. Update Content.mgcb to reference the extension assembly:
   Add at top of Content.mgcb:
   ```
   /reference:../Berzerk.ContentPipeline/bin/Debug/net8.0/Berzerk.ContentPipeline.dll
   ```

6. Add project dependency so content pipeline builds before game:
   Update Berzerk.csproj to add ProjectReference to Berzerk.ContentPipeline

Note: The /reference path in Content.mgcb uses relative path from Content folder.
  </action>
  <verify>
Run:
```bash
dotnet build Berzerk.sln
```
Both projects build successfully on macOS. Check that Berzerk.ContentPipeline.dll exists in bin/Debug/net8.0/.
  </verify>
  <done>
Content pipeline extension project compiles. Main game project has dependency on it. Content.mgcb references the extension DLL.
  </done>
</task>

</tasks>

<verification>
After both tasks complete:

1. Solution builds cleanly on macOS:
   ```bash
   dotnet build Berzerk.sln
   ```

2. Game runs on macOS:
   ```bash
   dotnet run --project Berzerk/Berzerk.csproj
   ```
   Window opens with cornflower blue background.

3. Project structure is correct:
   ```
   Berzerk/
   ├── Berzerk.sln
   ├── .config/dotnet-tools.json
   ├── Berzerk/
   │   ├── Berzerk.csproj
   │   ├── BerzerkGame.cs
   │   ├── Program.cs
   │   └── Content/
   │       └── Content.mgcb
   └── Berzerk.ContentPipeline/
       └── Berzerk.ContentPipeline.csproj
   ```

4. Content.mgcb has /reference to extension DLL

Note: Cross-platform build verification (Windows/Linux) deferred to later phase.
</verification>

<success_criteria>
- [ ] `dotnet build Berzerk.sln` succeeds with no errors on macOS
- [ ] `dotnet run --project Berzerk/Berzerk.csproj` opens game window on macOS
- [ ] Berzerk.ContentPipeline.dll exists after build
- [ ] Content.mgcb contains /reference directive
- [ ] BerzerkGame class exists (not Game1)
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-content-pipeline/01-01-SUMMARY.md`
</output>
